---
title: 数据中台事实表的划分
date: 2020-09-23 10:21:34
tags: [数据中台,数据仓库,事实表]
categories: 架构
---



​	_笔者这两日正好在给新公司做数据任务迁移，然后发现，旧平台的任务完全属于烟囱式开发，不太理解为啥这种也会自称是数据中台。然后在迁移结束之后，边了解这一块的业务，边给他做了一下架构设计，这里来聊一下其中事实表的部分_

### 维度建模（Kimball）

​	维度建模的特点在于，他是自上而下的，从业务出发，根据事实表和维度表来构建数据仓库，通过用数据冗余来换取查询的效率。是一种以消耗存储来换取计算速度的建模方式。维度描述了度量上下文的5W（who，what，when，where，why）信息，以及这些上下文是如何作用的。

​	这里提到了事实表和维度表两个概念，那么再小讲一下吧。

#### 	  事实表

+ 以业务过程为基础，一个独立的业务过程，对应一张事实表（当一个源表中包含了多个业务过程的时候，拆分他，别犹豫）
+ 含有维度属性以及至少一个度量
+ 通过维度属性与维表的一组外键关联，能唯一表示一行事实数据

  #### 维表

+ 储存某一维度属性上的详细信息
+ 维表包含事实表维度属性可以展开的相关细节。帮助业务分析人员更好的理解数据
+ 维表包含了对事实表度量的描述信息
+ 维表的属性出现在报告的行列标题中

### 数据域的划分

​	说到事实表的划分，那肯定要提业务过程，说到业务过程，那必定要说数据域划分。

1. 数据域是什么？

   ​	我理解数据域是一种抽象的范围，具有一定规模，相互独立互不重叠的业务范围。

2. 数据域怎么划分？

   ​	首先，要熟悉业务！重要的事情说三遍：**业务！业务！业务！**通过分析各个业务模块中的业务过程，对多个业务过程或者维度进行抽象集合，汇总相关的业务过程和维度为一个数据域。

3. 划分有什么原则吗？

   ​	**基于业务**

    + 同一数据域下的业务过程或相似或互相存在一些关联，他们的业务形式相同或者相似，例如下单、支付等流程，可以统一划在交易域中

    + 同一业务的不同阶段，也划分在同一数据域，比如加购和下单，都是交易业务，均抽象为交易域

    + 不同业务，分为不同数据域，像供应链中，下单和仓储物流，分为2个数据域，交易域和仓储物流域

      **具有一定规模和可扩展性**

   + 已经确定的不会轻易变动，可以进行一定的扩展

   + 涵盖当前已知的所有业务，每一个业务过程，均属于且只属于一个划分好的已知数据域

   + 当产生新的业务时，不会影响到既定的数据域，且可以融入或扩展到数据域中

4. 划分时有什么要注意的吗？

   ​	首先，要指定各个数据域的边界，划分清楚各自所包含的业务过程，并且互不重复。其次，举出涉及的相关业务过程。如果有特殊情况或者容易产生歧义的部分，在说明或者备注中指出。

### 事实表的设计原则

   ​	事实完整性、粒度一致性、事实可加性、维度退化、事实易用性、单位统一、业务相关、空值处理

#### 		事务粒度事实表

​		类似一些操作流水的表，在此基础上冗余部分维度，是描述业务过程，跟踪空间或时间上某点的度量事件保存的最原子的数据。一条记录代表实体的一个事务，只有在活动发生时插入，粒度一般是时间或者空间，并且在某个时刻，粒度必须为真。

#### 		周期快照事实表

​		具有规律性，在一定时间间隔下产生，每行代表某个时间周期的一个实体。记录的事实是时间周期内的聚集事实值或状态度量。

#### 		累计快照事实表

​		描述业务过程，跟踪时间或者空间上某点度量事件，保存最原子的数据。每行代表实体的一个事务。

   

### 维度表

​	按照阿里提出的中台架构理论：ODS、CDM以及ADS分层，其中CDM层可以看作一层dwd以及上层的dws和贯穿2层的dim层。这里，dwd常指事实表，dim即维表，维表又可以分为几种：

#### 	时间维度

​		每个事实表都是具有时间延续性的事实属性的记录组成的，所以至少具有一种的时间维。具体维度可以根据业务需求来进行调整，下面举例说明

​	![时间维表](../../../../source/_posts/image/数据中台事实表的划分_时间维表.png)

